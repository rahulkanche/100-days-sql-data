<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 19 - Data Download</title>
    <style>
        * {margin: 0;padding: 0;box-sizing: border-box;}
        body {font-family: Arial, sans-serif;background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);min-height: 100vh;padding: 40px 20px;}
        .container {max-width: 1100px;margin: 0 auto;}
        .hero {background: white;padding: 50px;border-radius: 15px;text-align: center;margin-bottom: 30px;box-shadow: 0 10px 40px rgba(0,0,0,0.2);}
        .hero h1 {color: #667eea;font-size: 42px;margin-bottom: 15px;}
        .hero p {font-size: 18px;color: #666;line-height: 1.8;}
        .topic-badges {margin: 20px 0;}
        .badge {display: inline-block;background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);color: white;padding: 8px 20px;border-radius: 20px;margin: 5px;font-size: 14px;font-weight: bold;}
        .table-section {background: white;padding: 40px;border-radius: 15px;margin-bottom: 25px;box-shadow: 0 5px 20px rgba(0,0,0,0.1);}
        .table-section h2 {color: #667eea;font-size: 28px;margin-bottom: 20px;}
        .download-btn {background: #10b981;color: white;border: none;padding: 12px 30px;border-radius: 8px;font-size: 16px;font-weight: bold;cursor: pointer;transition: background 0.3s;}
        .download-btn:hover {background: #059669;}
        table {width: 100%;border-collapse: collapse;margin: 20px 0;font-size: 14px;}
        table th {background: #667eea;color: white;padding: 12px;text-align: left;}
        table td {border: 1px solid #e2e8f0;padding: 10px;}
        table tr:nth-child(even) {background: #f7fafc;}
        .instructions {background: #fef3c7;border-left: 5px solid #f59e0b;padding: 25px;border-radius: 8px;margin-top: 30px;}
        .instructions h3 {color: #d97706;margin-bottom: 15px;font-size: 22px;}
        .instructions code {background: #fff;padding: 3px 8px;border-radius: 4px;color: #d97706;font-size: 14px;}
        .back-link {text-align: center;margin-top: 30px;}
        .back-link a {color: white;font-size: 18px;text-decoration: none;background: rgba(255,255,255,0.2);padding: 12px 30px;border-radius: 8px;display: inline-block;transition: background 0.3s;}
        .back-link a:hover {background: rgba(255,255,255,0.3);}
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>üìä Day 19 - Data Download</h1>
            <p style="font-size: 20px; color: #764ba2; font-weight: bold; margin: 15px 0;">Airline Flight Delays & Aircraft Utilization</p>
            <p>Download all 3 tables with complete messy data (25+ rows per table)</p>
            <div class="topic-badges">
                <span class="badge">Data Cleaning</span>
                <span class="badge">TIMESTAMPDIFF</span>
                <span class="badge">Multi-Table JOINs</span>
                <span class="badge">Performance Metrics</span>
                <span class="badge">CTEs</span>
            </div>
        </div>

        <div class="table-section">
            <h2>Table 1: flights</h2>
            <button class="download-btn" onclick="downloadCSV('flights')">‚¨áÔ∏è Download flights.csv</button>
            <table id="flights-table">
                <tr>
                    <th>flight_id</th>
                    <th>aircraft_id</th>
                    <th>route_id</th>
                    <th>flight_date</th>
                    <th>scheduled_departure</th>
                    <th>actual_departure</th>
                    <th>delay_minutes</th>
                    <th>status</th>
                </tr>
                <tr><td> FL001 </td><td>A101</td><td>R001</td><td>2024-01-15</td><td>08:00:00</td><td>08:00:00</td><td>0</td><td>ON TIME</td></tr>
                <tr><td>fl002</td><td>A102</td><td> r002 </td><td>2024-01-15</td><td>09:15:00</td><td>09:30:00</td><td>15</td><td>delayed</td></tr>
                <tr><td>FL003</td><td>A101</td><td>R003</td><td>2024-01-16</td><td>14:00:00</td><td>14:45:00</td><td>45</td><td>DELAYED</td></tr>
                <tr><td>fl004</td><td> A103 </td><td>R001</td><td>2024-01-16</td><td>07:30:00</td><td>07:30:00</td><td>0</td><td>On Time</td></tr>
                <tr><td>FL005</td><td>A102</td><td>r004</td><td>2024-01-17</td><td>12:00:00</td><td>NULL</td><td>NULL</td><td>CANCELLED</td></tr>
                <tr><td>fl006</td><td>A104</td><td>R002</td><td>2024-01-17</td><td>10:30:00</td><td>10:50:00</td><td>20</td><td>DELAYED</td></tr>
                <tr><td>FL007</td><td> A101 </td><td>r001</td><td>2024-01-18</td><td>15:00:00</td><td>15:35:00</td><td>35</td><td>delayed</td></tr>
                <tr><td>fl008</td><td>A105</td><td>R005</td><td>2024-01-18</td><td>11:45:00</td><td>11:55:00</td><td>10</td><td>DELAYED</td></tr>
                <tr><td>FL009</td><td>A103</td><td>R003</td><td>2024-01-19</td><td>13:20:00</td><td>13:20:00</td><td>0</td><td>ON TIME</td></tr>
                <tr><td>fl010</td><td>A102</td><td> r004 </td><td>2024-01-19</td><td>16:00:00</td><td>16:25:00</td><td>25</td><td>Delayed</td></tr>
                <tr><td>FL011</td><td>A101</td><td>R002</td><td>2024-01-20</td><td>09:00:00</td><td>09:50:00</td><td>50</td><td>DELAYED</td></tr>
                <tr><td>fl012</td><td>A104</td><td>r001</td><td>2024-01-20</td><td>14:30:00</td><td>14:30:00</td><td>0</td><td>On Time</td></tr>
                <tr><td>FL013</td><td> A105 </td><td>R005</td><td>2024-01-21</td><td>12:15:00</td><td>12:20:00</td><td>5</td><td>delayed</td></tr>
                <tr><td>fl014</td><td>A101</td><td>R003</td><td>2024-01-21</td><td>17:00:00</td><td>17:40:00</td><td>40</td><td>DELAYED</td></tr>
                <tr><td>FL015</td><td>A103</td><td> r002 </td><td>2024-01-22</td><td>08:30:00</td><td>08:30:00</td><td>0</td><td>ON TIME</td></tr>
                <tr><td>fl016</td><td>A102</td><td>R004</td><td>2024-01-22</td><td>11:00:00</td><td>11:20:00</td><td>20</td><td>Delayed</td></tr>
                <tr><td>FL017</td><td>A104</td><td>r001</td><td>2024-01-23</td><td>15:45:00</td><td>16:00:00</td><td>15</td><td>delayed</td></tr>
                <tr><td>fl018</td><td> A101 </td><td>R005</td><td>2024-01-23</td><td>10:00:00</td><td>10:45:00</td><td>45</td><td>DELAYED</td></tr>
                <tr><td>FL019</td><td>A105</td><td>R002</td><td>2024-01-24</td><td>13:30:00</td><td>13:40:00</td><td>10</td><td>DELAYED</td></tr>
                <tr><td>fl020</td><td>A103</td><td> r003 </td><td>2024-01-24</td><td>16:15:00</td><td>16:15:00</td><td>0</td><td>On Time</td></tr>
                <tr><td>FL021</td><td>A101</td><td>R001</td><td>2024-01-25</td><td>09:30:00</td><td>10:00:00</td><td>30</td><td>delayed</td></tr>
                <tr><td>fl022</td><td>A102</td><td>r004</td><td>2024-01-25</td><td>14:00:00</td><td>14:25:00</td><td>25</td><td>DELAYED</td></tr>
                <tr><td>FL023</td><td> A104 </td><td>R002</td><td>2024-01-26</td><td>11:30:00</td><td>11:30:00</td><td>0</td><td>ON TIME</td></tr>
                <tr><td>fl024</td><td>A105</td><td>R005</td><td>2024-01-26</td><td>15:00:00</td><td>15:18:00</td><td>18</td><td>Delayed</td></tr>
                <tr><td>FL025</td><td>A101</td><td> r003 </td><td>2024-01-27</td><td>12:45:00</td><td>13:30:00</td><td>45</td><td>DELAYED</td></tr>
            </table>
        </div>

        <div class="table-section">
            <h2>Table 2: aircraft</h2>
            <button class="download-btn" onclick="downloadCSV('aircraft')">‚¨áÔ∏è Download aircraft.csv</button>
            <table id="aircraft-table">
                <tr>
                    <th>aircraft_id</th>
                    <th>model</th>
                    <th>manufacturer</th>
                    <th>year_manufactured</th>
                    <th>seat_capacity</th>
                    <th>last_maintenance</th>
                </tr>
                <tr><td>A101</td><td>737-800</td><td>Boeing</td><td>2018</td><td>189</td><td>2024-01-10</td></tr>
                <tr><td>A102</td><td>A320</td><td>Airbus</td><td>2019</td><td>180</td><td>NULL</td></tr>
                <tr><td>A103</td><td>737-900</td><td>Boeing</td><td>2020</td><td>220</td><td>2024-01-05</td></tr>
                <tr><td>A104</td><td>A321</td><td>Airbus</td><td>2017</td><td>220</td><td>2023-12-28</td></tr>
                <tr><td>A105</td><td>737-800</td><td>Boeing</td><td>2021</td><td>189</td><td>2024-01-12</td></tr>
            </table>
        </div>

        <div class="table-section">
            <h2>Table 3: routes</h2>
            <button class="download-btn" onclick="downloadCSV('routes')">‚¨áÔ∏è Download routes.csv</button>
            <table id="routes-table">
                <tr>
                    <th>route_id</th>
                    <th>origin</th>
                    <th>destination</th>
                    <th>distance_km</th>
                    <th>flight_duration_min</th>
                </tr>
                <tr><td>R001</td><td>Mumbai</td><td>Delhi</td><td>1400</td><td>150</td></tr>
                <tr><td>R002</td><td>Delhi</td><td>Bangalore</td><td>1740</td><td>180</td></tr>
                <tr><td>R003</td><td>Mumbai</td><td>Bangalore</td><td>980</td><td>140</td></tr>
                <tr><td>R004</td><td>Delhi</td><td>Kolkata</td><td>1350</td><td>165</td></tr>
                <tr><td>R005</td><td>Chennai</td><td>Hyderabad</td><td>625</td><td>95</td></tr>
            </table>
        </div>

        <div class="table-section">
            <div class="instructions">
                <h3>üìå How to Import into MySQL/PostgreSQL</h3>
                <p><strong>MySQL:</strong></p>
                <p>1. Create database: <code>CREATE DATABASE airline_db;</code></p>
                <p>2. Import CSV: <code>LOAD DATA INFILE 'path/flights.csv' INTO TABLE flights FIELDS TERMINATED BY ',' ENCLOSED BY '"' LINES TERMINATED BY '\n' IGNORE 1 ROWS;</code></p>
                <br>
                <p><strong>PostgreSQL:</strong></p>
                <p>1. Create database: <code>CREATE DATABASE airline_db;</code></p>
                <p>2. Import CSV: <code>\COPY flights FROM 'path/flights.csv' WITH (FORMAT csv, HEADER true);</code></p>
                <br>
                <p><strong>Note:</strong> Create tables first with appropriate column types before importing!</p>
            </div>
        </div>

        <div class="back-link">
            <a href="day-19-challenge.html">‚Üê Back to Challenge</a>
        </div>
    </div>

    <script>
        function downloadCSV(tableName) {
            const table = document.getElementById(tableName + '-table');
            let csv = [];
            const rows = table.querySelectorAll('tr');
            for (let row of rows) {
                let cols = row.querySelectorAll('td, th');
                let csvRow = [];
                for (let col of cols) {
                    csvRow.push('"' + col.innerText.replace(/"/g, '""') + '"');
                }
                csv.push(csvRow.join(','));
            }
            const csvContent = csv.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'day_19_' + tableName + '.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>
